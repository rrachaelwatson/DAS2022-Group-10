---
title: "Influential factors of days spent at the shelter"
author: "Hanfan Chen 2703334C, Zhaohao Li 2611602L, Zhenhao Qiao 2612824Q, Chao Wang 2518608W, RachaelWatson 2195719W"
output:
  pdf_document:
    number_sections: yes
fig_caption: yes
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE}
knitr::opts_chunk$set(eval = T, echo = FALSE, comment = NA, message = FALSE, warning = FALSE)
```

# Introduction

```{r library}
library(ggplot2)
library(GGally)
library(tidyverse)
library(kableExtra)
```

# Exploratory Data Analysis
```{r read the data}
data10 <- read.csv("dataset10.csv")
str(data10)
```

```{r}
for (i in 1:6) {
  cat("Column", i,":\n")
  print(levels(as.factor(data10[,i])))
  cat("\n")
}
data10[,2] <- as.factor(data10[,2])
data10[,3] <- as.factor(data10[,3])
```
All the explanatory variable are categorical variable and each explanatory variable have multiple levels.

```{r}
zero_data <- subset(data10, time_at_shelter == 0)
nrow(zero_data)
```
Excess zeros in raw data may cause overdispersion in Poisson regression. The hurdle model is suggested to fit.

```{r hist of y, fig.cap = "\\label{fig:y_hist} The histogram of day time at shelter", fig.width = 10, fig.align = "center", fig.pos = "H"}
ggplot(data10, mapping = aes(x = time_at_shelter)) + 
  geom_histogram(bins = 25)
```
Figure \ref{fig:y_hist} displays the histogram of the response variable, which is days time in the shelter. The histogram shows evidence of right-skewed and Poisson distribution of the response variable.

```{r pair plots, fig.cap = "\\label{fig:pairs} Pair plots of the variables", fig.width = 10, fig.align = "center", fig.pos = "H"}
ggpairs(data10,
upper=list(continuous=wrap("points", alpha=0.4)),
lower="blank", axisLabels="none")
```

Since the response variable is right-skewed, a median of the response variable is calculated. The figures below display the median of each category of the different explanatory variables.
```{r bar plot 1, fig.cap = "\\label{fig:animal_bar} Bar plot of animal type vs time at shelter", fig.width = 10, fig.align = "center", fig.pos = "H"}
animal_bar <- data10 %>% 
  select(time_at_shelter, animal_type) %>% 
  group_by(animal_type) %>% 
  summarise(median = median(time_at_shelter))
ggplot(animal_bar, aes(x = animal_type, y = median, colour=animal_type, fill=animal_type)) +
  geom_col() +
  labs(x="Animal type", y="Time at Shelter")
```

```{r bar plot 2, fig.cap = "\\label{fig:month_bar} Bar plot of month vs time at shelter", fig.width = 10, fig.align = "center", fig.pos = "H"}
month_bar <- data10 %>% 
  select(time_at_shelter, month) %>% 
  group_by(month) %>% 
  summarise(median = median(time_at_shelter))
ggplot(month_bar, aes(x = month, y = median, fill=month)) +
  geom_col() +
  labs(x="Month", y="Time at Shelter")
```

```{r bar plot 3, fig.cap = "\\label{fig:year_bar} Bar plot of year vs time at shelter", fig.width = 10, fig.align = "center", fig.pos = "H"}
year_bar <- data10 %>% 
  select(time_at_shelter, year) %>% 
  group_by(year) %>% 
  summarise(median = median(time_at_shelter))
ggplot(year_bar, aes(x = year, y = median, fill=year)) +
  geom_col() +
  labs(x="Year", y="Time at Shelter")
```

```{r bar plot 4, fig.cap = "\\label{fig:intake_bar} Bar plot of intake type vs time at shelter", fig.width = 10, fig.align = "center", fig.pos = "H"}
intake_bar <- data10 %>% 
  select(time_at_shelter, intake_type) %>% 
  group_by(intake_type) %>% 
  summarise(median = median(time_at_shelter))
ggplot(intake_bar, aes(x = intake_type, y = median, fill=intake_type)) +
  geom_col() +
  labs(x="Intake type", y="Time at Shelter")
```

```{r bar plot 5, fig.cap = "\\label{fig:outcome_bar} Bar plot of outcome type vs time at shelter", fig.width = 10, fig.align = "center", fig.pos = "H"}
outcome_bar <- data10 %>% 
  select(time_at_shelter, outcome_type) %>% 
  group_by(outcome_type) %>% 
  summarise(median = median(time_at_shelter))
ggplot(outcome_bar, aes(x = outcome_type, y = median, fill=outcome_type)) +
  geom_col() +
  labs(x="Outcome type", y="Time at Shelter")
```

```{r bar plot 6, fig.cap = "\\label{fig:chip_bar} Bar plot of chip status vs time at shelter", fig.width = 10, fig.align = "center", fig.pos = "H"}
chip_bar <- data10 %>% 
  select(time_at_shelter, chip_status) %>% 
  group_by(chip_status) %>% 
  summarise(median = median(time_at_shelter))
ggplot(chip_bar, aes(x = chip_status, y = median, fill=chip_status)) +
  geom_col() +
  labs(x="Chip status", y="Time at Shelter")
```

# Formal Data Analysis

# Conclusions {#sec:Conc}










































